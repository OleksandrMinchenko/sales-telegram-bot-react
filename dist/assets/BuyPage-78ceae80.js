import{r as a,j as e}from"./index-72685862.js";import{n as g,c as F}from"./notiflix-notify-aio-a7bb5e95.js";import{P as x,M as G,C as U,a as v,i as H,o as q,L as z,s as J,B as K,u as X}from"./isObjectEmpty-8abe88ef.js";import{u as W,L as Y}from"./Loader-74f30f07.js";import{R as Q}from"./Ruls-bc3fe234.js";import{n}from"./emotion-styled.browser.esm-e07269da.js";import{a as Z,l as ee,i as se,t as te,e as oe,b as M,s as re}from"./mixins-0b8905f2.js";import{M as ae,B as ne,a as T}from"./pagesStyle-bbdac604.js";import"./firebase.config-a847182b.js";const ie=n.form`
  ${Z}
`,y=n.label`
  ${ee}
`,ce=n.input`
  ${se}
`,le=n.textarea`
  ${te}
`,A=n.span`
  ${oe}
`;n.button`
  ${M}
`;const de=n.button`
  ${M}
  ${re}
`;g.Notify.init({borderRadius:"8px",useIcon:!1,plainText:!1,fontSize:"18px",success:{textColor:"#ffd700",background:"#0057b8"},failure:{background:"#ff5549"}});const ue={isAccept:!1,title:"",description:"",contact:""},pe={headers:{"Content-Type":"application/json"}},L=({user:o,queryId:l,onClose:d})=>{var _,j;const{register:s,handleSubmit:i,getValues:u,setValue:p,reset:c,formState:{errors:r,isValid:V,isDirty:B}}=W({defaultValues:ue,resolver:q(K),mode:"onChange"}),[E,S]=a.useState(0),[N,R]=a.useState(!1),[O,I]=a.useState(u("isAccept")),[k,f]=a.useState(!1),D=({target:t})=>{const m=z-t.value.length;S(h=>m)},P=()=>{p("contact",`@${o}`,{shouldValidate:!0})},b=()=>{R(t=>!t)},$=async t=>{f(!0);const m=JSON.stringify({...t,user:o,queryId:l});try{if(await J("/web-data-buy",m,pe)){g.Notify.success("Ваше оголошення відправлено!"),d(),c(),I(!1),f(!1),S(0);return}}catch(h){g.Notify.failure(`Помилка відправки оголошення! <br> ${h.message}`),f(!1)}},w=t=>{console.log("form onErrors",t)};return e.jsxs(e.Fragment,{children:[k&&e.jsx(Y,{}),N&&e.jsx(G,{toggleRulsModal:b,children:e.jsx(Q,{})}),e.jsxs(ie,{onSubmit:i($,w),autoComplete:"off",children:[e.jsx(U,{register:s,setIsChecked:I,isChecked:O,toggleRulsModal:b,errors:r}),e.jsxs(y,{children:[e.jsx("h2",{children:"Заголовок"}),e.jsx(ce,{...s("title"),placeholder:"Куплю Iphone 12 256 GB"}),e.jsx(A,{children:(_=r.title)==null?void 0:_.message})]}),e.jsxs(y,{children:[e.jsx("h2",{children:"Опис товару"}),E>0&&e.jsxs("p",{children:["до ",E," символів"]}),e.jsx(le,{...s("description",{onChange:t=>D(t)}),rows:"2",cols:"50",placeholder:"Колір чорний, памʼять 256 GB..."}),e.jsx(A,{children:(j=r.description)==null?void 0:j.message})]}),e.jsx(v,{register:s,setContact:P,errors:r}),e.jsx(de,{disabled:!B||!V||!H(r),type:"submit","aria-label":"Send",children:"Відправити"})]})]})};L.propTypes={user:x.string,queryId:x.string,onClose:x.func};const{VITE_BOT_NAME:C}={VITE_API_KEY:"AIzaSyDjaop_dMf76XIw9kE5rAx6GS8iB2xIGFI",VITE_AUTH_DOMAIN:"telegram-bot-d339c.firebaseapp.com",VITE_PROJECT_ID:"telegram-bot-d339c",VITE_STORAGE_BUCKET:"telegram-bot-d339c.appspot.com",VITE_MESSAGING_SENDER_ID:"1063834393786",VITE_APP_ID:"1:1063834393786:web:f3a8d12d6afa1f8d713683",VITE_MEASUREMENT_ID:"G-2S51PS053E",VITE_BOT_NAME:"cat_gm_bot",VITE_CHANNEL_NAME:"production_buy_sale",VITE_COLLECTION:"users",BASE_URL:"/sales-telegram-bot-react/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},_e=()=>{const{user:o,onClose:l,queryId:d}=X(),[s,i]=a.useState({}),[u,p]=a.useState(!0);if(a.useEffect(()=>{(async()=>{const r=await F(o);i(r)})()},[o,i]),!o)return e.jsx(e.Fragment,{children:e.jsxs(ae,{children:["Немає користувача. ",e.jsx("br",{})," Запускай бота",e.jsx(ne,{href:`https://t.me/${C}`,target:"_blank",rel:"noopener noreferrer","aria-label":"link to telegram bot",children:`@${C}`})]})});if(s.permission===!1)return e.jsx(T,{children:s.text});if(s.permission===!0){const c=setTimeout(()=>{p(!1),clearTimeout(c)},4e3);return e.jsxs(e.Fragment,{children:[u&&e.jsx(T,{children:s.text}),e.jsx(L,{user:o,queryId:d,onClose:l})]})}};export{_e as default};
